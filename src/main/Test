package com.alibaba.aone.platform.dal.navigation;

import java.math.BigInteger;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import uk.co.jemos.podam.api.PodamFactory;
import uk.co.jemos.podam.api.PodamFactoryImpl;

import static com.google.common.truth.Truth.assertThat;

public class NavigationDaoTest extends BaseDaoTestCase {

    @Autowired
    private NavigationDao navigationDao;
    private PodamFactory podamFactory = new PodamFactoryImpl();

    @Test
    public void test_insert() {
        Navigation navigation = podamFactory.manufacturePojo(Navigation.class);
        navigation.setDefault(true);
        navigationDao.insert(navigation);

        assertThat(navigation.getId()).isNotNull();

        Map<String, Object> params = new HashMap<>();
        params.put("id", navigation.getId());
        List<Map<String, Object>> resultList = jdbcTemplate.queryForList("select * from navigation where id=:id", params);
        assertThat(resultList.get(0).get("id")).isEqualTo(BigInteger.valueOf(navigation.getId()));
        assertThat(resultList.get(0).get("is_default")).isEqualTo(1);
    }
}
